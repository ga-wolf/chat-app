{"id":"B8gL","dependencies":[{"name":"/Users/jackjeffress/Desktop/our-react-chat-app/node_modules/@supabase/realtime-js/dist/module/lib/push.js.map","includedInParent":true,"mtime":1630063737471},{"name":"/Users/jackjeffress/Desktop/our-react-chat-app/node_modules/@supabase/realtime-js/src/lib/push.ts","includedInParent":true,"mtime":1630063737540},{"name":"/Users/jackjeffress/Desktop/our-react-chat-app/package.json","includedInParent":true,"mtime":1630063738273},{"name":"/Users/jackjeffress/Desktop/our-react-chat-app/node_modules/@supabase/realtime-js/package.json","includedInParent":true,"mtime":1630063737423},{"name":"../lib/constants","loc":{"line":1,"column":32},"parent":"/Users/jackjeffress/Desktop/our-react-chat-app/node_modules/@supabase/realtime-js/dist/module/lib/push.js","resolved":"/Users/jackjeffress/Desktop/our-react-chat-app/node_modules/@supabase/realtime-js/dist/module/lib/constants.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=require(\"../lib/constants\");class t{constructor(t,s,i={},h=e.DEFAULT_TIMEOUT){this.channel=t,this.event=s,this.payload=i,this.timeout=h,this.sent=!1,this.timeoutTimer=void 0,this.ref=\"\",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref=\"\",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived(\"timeout\")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger(\"timeout\",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}exports.default=t;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":0}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":13}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":20}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":35}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":43}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":56}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":57}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":64}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":68}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":76}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":89}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":91}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":95}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":97}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":105}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":14},"generated":{"line":1,"column":125}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":21},"generated":{"line":1,"column":131}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":26,"column":2},"generated":{"line":1,"column":133}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":27,"column":11},"generated":{"line":1,"column":145}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":28,"column":11},"generated":{"line":1,"column":147}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":29,"column":11},"generated":{"line":1,"column":149}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":29,"column":26},"generated":{"line":1,"column":151}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":30,"column":11},"generated":{"line":1,"column":154}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":30,"column":29},"generated":{"line":1,"column":156}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":26,"column":2},"generated":{"line":1,"column":158}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":27,"column":11},"generated":{"line":1,"column":175}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":27,"column":11},"generated":{"line":1,"column":180}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":27,"column":11},"generated":{"line":1,"column":188}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":28,"column":11},"generated":{"line":1,"column":190}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":28,"column":11},"generated":{"line":1,"column":195}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":28,"column":11},"generated":{"line":1,"column":201}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":29,"column":11},"generated":{"line":1,"column":203}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":29,"column":11},"generated":{"line":1,"column":208}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":29,"column":11},"generated":{"line":1,"column":216}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":30,"column":11},"generated":{"line":1,"column":218}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":30,"column":11},"generated":{"line":1,"column":223}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":30,"column":11},"generated":{"line":1,"column":231}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":5,"column":2},"generated":{"line":1,"column":233}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":5,"column":2},"generated":{"line":1,"column":238}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":5,"column":18},"generated":{"line":1,"column":244}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":6,"column":2},"generated":{"line":1,"column":246}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":6,"column":2},"generated":{"line":1,"column":251}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":6,"column":37},"generated":{"line":1,"column":269}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":7,"column":2},"generated":{"line":1,"column":271}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":7,"column":2},"generated":{"line":1,"column":276}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":7,"column":16},"generated":{"line":1,"column":280}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":8,"column":2},"generated":{"line":1,"column":283}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":8,"column":2},"generated":{"line":1,"column":288}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":11,"column":13},"generated":{"line":1,"column":301}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":12,"column":2},"generated":{"line":1,"column":306}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":12,"column":2},"generated":{"line":1,"column":311}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":15,"column":8},"generated":{"line":1,"column":320}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":16,"column":2},"generated":{"line":1,"column":323}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":16,"column":2},"generated":{"line":1,"column":328}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":16,"column":28},"generated":{"line":1,"column":337}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":33,"column":2},"generated":{"line":1,"column":342}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":33,"column":9},"generated":{"line":1,"column":349}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":34,"column":9},"generated":{"line":1,"column":352}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":34,"column":9},"generated":{"line":1,"column":357}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":34,"column":19},"generated":{"line":1,"column":365}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":35,"column":9},"generated":{"line":1,"column":367}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":35,"column":9},"generated":{"line":1,"column":372}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":36,"column":9},"generated":{"line":1,"column":390}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":36,"column":9},"generated":{"line":1,"column":395}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":36,"column":15},"generated":{"line":1,"column":399}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":37,"column":9},"generated":{"line":1,"column":402}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":37,"column":9},"generated":{"line":1,"column":407}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":37,"column":20},"generated":{"line":1,"column":416}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":38,"column":9},"generated":{"line":1,"column":421}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":38,"column":9},"generated":{"line":1,"column":426}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":38,"column":24},"generated":{"line":1,"column":439}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":39,"column":9},"generated":{"line":1,"column":444}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":39,"column":9},"generated":{"line":1,"column":449}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":39,"column":16},"generated":{"line":1,"column":455}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":40,"column":9},"generated":{"line":1,"column":457}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":40,"column":9},"generated":{"line":1,"column":462}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":43,"column":2},"generated":{"line":1,"column":469}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":44,"column":8},"generated":{"line":1,"column":476}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":44,"column":13},"generated":{"line":1,"column":481}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":44,"column":26},"generated":{"line":1,"column":494}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":47,"column":9},"generated":{"line":1,"column":507}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":47,"column":9},"generated":{"line":1,"column":512}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":48,"column":9},"generated":{"line":1,"column":527}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":48,"column":9},"generated":{"line":1,"column":532}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":48,"column":16},"generated":{"line":1,"column":538}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":49,"column":9},"generated":{"line":1,"column":540}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":49,"column":9},"generated":{"line":1,"column":545}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":49,"column":17},"generated":{"line":1,"column":553}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":49,"column":24},"generated":{"line":1,"column":560}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":49,"column":29},"generated":{"line":1,"column":565}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":1,"column":566}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":50,"column":13},"generated":{"line":1,"column":572}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":50,"column":18},"generated":{"line":1,"column":577}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":50,"column":26},"generated":{"line":1,"column":585}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":51,"column":6},"generated":{"line":1,"column":591}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":51,"column":13},"generated":{"line":1,"column":597}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":51,"column":18},"generated":{"line":1,"column":602}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":52,"column":6},"generated":{"line":1,"column":608}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":52,"column":15},"generated":{"line":1,"column":616}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":52,"column":20},"generated":{"line":1,"column":621}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":53,"column":6},"generated":{"line":1,"column":629}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":53,"column":11},"generated":{"line":1,"column":633}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":53,"column":16},"generated":{"line":1,"column":638}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":57,"column":2},"generated":{"line":1,"column":645}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":57,"column":10},"generated":{"line":1,"column":653}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":57,"column":26},"generated":{"line":1,"column":655}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":658}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":662}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":63,"column":11},"generated":{"line":1,"column":664}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":58,"column":8},"generated":{"line":1,"column":671}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":58,"column":13},"generated":{"line":1,"column":676}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":58,"column":26},"generated":{"line":1,"column":689}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":6},"generated":{"line":1,"column":693}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":32},"generated":{"line":1,"column":695}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":14},"generated":{"line":1,"column":703}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":15},"generated":{"line":1,"column":705}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":20},"generated":{"line":1,"column":710}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":32},"generated":{"line":1,"column":730}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":32},"generated":{"line":1,"column":734}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":32},"generated":{"line":1,"column":741}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":32},"generated":{"line":1,"column":743}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":59,"column":34},"generated":{"line":1,"column":745}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":9},"generated":{"line":1,"column":755}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":9},"generated":{"line":1,"column":760}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":18},"generated":{"line":1,"column":769}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":23},"generated":{"line":1,"column":774}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":25},"generated":{"line":1,"column":775}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":25},"generated":{"line":1,"column":782}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":33},"generated":{"line":1,"column":784}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":62,"column":33},"generated":{"line":1,"column":793}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":63,"column":11},"generated":{"line":1,"column":797}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":66,"column":2},"generated":{"line":1,"column":802}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":67,"column":8},"generated":{"line":1,"column":817}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":67,"column":13},"generated":{"line":1,"column":822}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":70,"column":9},"generated":{"line":1,"column":837}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":70,"column":9},"generated":{"line":1,"column":842}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":70,"column":15},"generated":{"line":1,"column":846}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":70,"column":20},"generated":{"line":1,"column":851}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":70,"column":28},"generated":{"line":1,"column":859}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":70,"column":35},"generated":{"line":1,"column":866}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":9},"generated":{"line":1,"column":876}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":9},"generated":{"line":1,"column":881}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":20},"generated":{"line":1,"column":890}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":25},"generated":{"line":1,"column":895}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":33},"generated":{"line":1,"column":903}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":48},"generated":{"line":1,"column":918}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":71,"column":53},"generated":{"line":1,"column":923}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":73,"column":9},"generated":{"line":1,"column":928}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":73,"column":9},"generated":{"line":1,"column":933}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":73,"column":17},"generated":{"line":1,"column":941}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":73,"column":20},"generated":{"line":1,"column":944}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":73,"column":25},"generated":{"line":1,"column":949}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":73,"column":36},"generated":{"line":1,"column":958}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":74,"column":11},"generated":{"line":1,"column":962}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":74,"column":11},"generated":{"line":1,"column":967}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":75,"column":11},"generated":{"line":1,"column":985}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":75,"column":11},"generated":{"line":1,"column":990}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":76,"column":11},"generated":{"line":1,"column":1007}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":76,"column":11},"generated":{"line":1,"column":1012}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":76,"column":26},"generated":{"line":1,"column":1025}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":77,"column":11},"generated":{"line":1,"column":1027}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":77,"column":11},"generated":{"line":1,"column":1032}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":77,"column":25},"generated":{"line":1,"column":1046}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":80,"column":9},"generated":{"line":1,"column":1051}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":80,"column":9},"generated":{"line":1,"column":1056}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":80,"column":29},"generated":{"line":1,"column":1069}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":80,"column":40},"generated":{"line":1,"column":1080}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":81,"column":11},"generated":{"line":1,"column":1085}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":81,"column":11},"generated":{"line":1,"column":1090}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":81,"column":19},"generated":{"line":1,"column":1098}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":81,"column":30},"generated":{"line":1,"column":1108}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":82,"column":7},"generated":{"line":1,"column":1113}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":82,"column":12},"generated":{"line":1,"column":1118}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":85,"column":2},"generated":{"line":1,"column":1128}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":85,"column":10},"generated":{"line":1,"column":1136}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":85,"column":26},"generated":{"line":1,"column":1138}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":8},"generated":{"line":1,"column":1141}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":13},"generated":{"line":1,"column":1146}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":23},"generated":{"line":1,"column":1156}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":28},"generated":{"line":1,"column":1161}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":36},"generated":{"line":1,"column":1169}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":44},"generated":{"line":1,"column":1177}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":49},"generated":{"line":1,"column":1182}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":59},"generated":{"line":1,"column":1191}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":61},"generated":{"line":1,"column":1192}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":61},"generated":{"line":1,"column":1199}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":69},"generated":{"line":1,"column":1201}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":86,"column":69},"generated":{"line":1,"column":1210}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":89,"column":2},"generated":{"line":1,"column":1214}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":1,"column":1224}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":1,"column":1229}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":91,"column":9},"generated":{"line":1,"column":1247}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":91,"column":9},"generated":{"line":1,"column":1252}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":94,"column":10},"generated":{"line":1,"column":1269}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":95,"column":9},"generated":{"line":1,"column":1287}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":95,"column":14},"generated":{"line":1,"column":1292}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":98,"column":9},"generated":{"line":1,"column":1302}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":98,"column":9},"generated":{"line":1,"column":1307}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":98,"column":17},"generated":{"line":1,"column":1315}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":98,"column":21},"generated":{"line":1,"column":1319}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":98,"column":26},"generated":{"line":1,"column":1324}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":101,"column":10},"generated":{"line":1,"column":1334}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":102,"column":4},"generated":{"line":1,"column":1351}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":102,"column":17},"generated":{"line":1,"column":1364}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":102,"column":22},"generated":{"line":1,"column":1369}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":103,"column":9},"generated":{"line":1,"column":1383}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":103,"column":9},"generated":{"line":1,"column":1388}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":103,"column":24},"generated":{"line":1,"column":1406}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":106,"column":10},"generated":{"line":1,"column":1408}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":106,"column":24},"generated":{"line":1,"column":1423}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":107,"column":4},"generated":{"line":1,"column":1430}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":106,"column":24},"generated":{"line":1,"column":1432}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":108,"column":4},"generated":{"line":1,"column":1441}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":113,"column":9},"generated":{"line":1,"column":1445}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":113,"column":9},"generated":{"line":1,"column":1450}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":114,"column":7},"generated":{"line":1,"column":1459}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":114,"column":15},"generated":{"line":1,"column":1466}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":114,"column":21},"generated":{"line":1,"column":1469}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":114,"column":23},"generated":{"line":1,"column":1471}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":114,"column":34},"generated":{"line":1,"column":1480}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":115,"column":7},"generated":{"line":1,"column":1483}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":115,"column":16},"generated":{"line":1,"column":1491}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":115,"column":22},"generated":{"line":1,"column":1494}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":115,"column":24},"generated":{"line":1,"column":1496}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":115,"column":33},"generated":{"line":1,"column":1505}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":118,"column":10},"generated":{"line":1,"column":1509}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":118,"column":23},"generated":{"line":1,"column":1522}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":11},"generated":{"line":1,"column":1525}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":11},"generated":{"line":1,"column":1532}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":16},"generated":{"line":1,"column":1537}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":32},"generated":{"line":1,"column":1551}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":37},"generated":{"line":1,"column":1556}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":50},"generated":{"line":1,"column":1569}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":119,"column":61},"generated":{"line":1,"column":1578}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":1581}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":1589}},{"source":"../../../src/lib/push.ts","name":null,"original":{"line":4,"column":25},"generated":{"line":1,"column":1597}}],"sources":{"../../../src/lib/push.ts":"import { DEFAULT_TIMEOUT } from '../lib/constants'\nimport RealtimeSubscription from '../RealtimeSubscription'\n\nexport default class Push {\n  sent: boolean = false\n  timeoutTimer: number | undefined = undefined\n  ref: string = ''\n  receivedResp: {\n    status: string\n    response: Function\n  } | null = null\n  recHooks: {\n    status: string\n    callback: Function\n  }[] = []\n  refEvent: string | null = null\n\n  /**\n   * Initializes the Push\n   *\n   * @param channel The Channel\n   * @param event The event, for example `\"phx_join\"`\n   * @param payload The payload, for example `{user_id: 123}`\n   * @param timeout The push timeout in milliseconds\n   */\n  constructor(\n    public channel: RealtimeSubscription,\n    public event: string,\n    public payload: any = {},\n    public timeout: number = DEFAULT_TIMEOUT\n  ) {}\n\n  resend(timeout: number) {\n    this.timeout = timeout\n    this._cancelRefEvent()\n    this.ref = ''\n    this.refEvent = null\n    this.receivedResp = null\n    this.sent = false\n    this.send()\n  }\n\n  send() {\n    if (this._hasReceived('timeout')) {\n      return\n    }\n    this.startTimeout()\n    this.sent = true\n    this.channel.socket.push({\n      topic: this.channel.topic,\n      event: this.event,\n      payload: this.payload,\n      ref: this.ref,\n    })\n  }\n\n  receive(status: string, callback: Function) {\n    if (this._hasReceived(status)) {\n      callback(this.receivedResp?.response)\n    }\n\n    this.recHooks.push({ status, callback })\n    return this\n  }\n\n  startTimeout() {\n    if (this.timeoutTimer) {\n      return\n    }\n    this.ref = this.channel.socket.makeRef()\n    this.refEvent = this.channel.replyEventName(this.ref)\n\n    this.channel.on(this.refEvent, (payload: any) => {\n      this._cancelRefEvent()\n      this._cancelTimeout()\n      this.receivedResp = payload\n      this._matchReceive(payload)\n    })\n\n    this.timeoutTimer = <any>setTimeout(() => {\n      this.trigger('timeout', {})\n    }, this.timeout)\n  }\n\n  trigger(status: string, response: any) {\n    if (this.refEvent) this.channel.trigger(this.refEvent, { status, response })\n  }\n\n  destroy() {\n    this._cancelRefEvent()\n    this._cancelTimeout()\n  }\n\n  private _cancelRefEvent() {\n    if (!this.refEvent) {\n      return\n    }\n    this.channel.off(this.refEvent)\n  }\n\n  private _cancelTimeout() {\n    clearTimeout(this.timeoutTimer)\n    this.timeoutTimer = undefined\n  }\n\n  private _matchReceive({\n    status,\n    response,\n  }: {\n    status: string\n    response: Function\n  }) {\n    this.recHooks\n      .filter((h) => h.status === status)\n      .forEach((h) => h.callback(response))\n  }\n\n  private _hasReceived(status: string) {\n    return this.receivedResp && this.receivedResp.status === status\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"771ba852619b7be37148a6fa172387cd","cacheData":{"env":{}}}